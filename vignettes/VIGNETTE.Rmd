---
title: "VIGNETTE"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{VIGNETTE}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(wrappify)
```

## Seamless Conversion of Artist/Song names to their IDs

Spotify works exclusively through object IDs, but as people of culture we know
our favourite artists, tracks, and podcasts by their names, not IDs. As such, we
need to be able to convert these names into their IDs as seamlessly as possible.

Note that artist and track names do not need to be formatted or spelled correctly to
yield valid search results!

```{r}
# One artist, mispelled
getArtistID('sanTanana')


# Multiple artists, seamlessly
artists_of_interest <- c('alt j', 'vulfpeck', 'herbie hancock0')

do.call(rbind, lapply(artists_of_interest, getArtistID))
```

When searching for tracks you can also include artist names to narrow down
what track you're looking for!
```{r}
# Song limit defaults to 5
getTrackID('Love')

# User can increase limits
getTrackID('Love', limit = 10)

# User can search with artist name in the string for more precise results
getTrackID('Love whitney houston')
```


## Spotify Functions for Track and Artist Information

```{r}
# We can search for an artist by their Spotify id
getArtistInfo("1Qp56T7n950O3EGMsSl81D", dataframe = T)
```

```{r}
# If we don't know that, we can use their name as a search query
getArtistInfo("Ghost", byName = TRUE, dataframe = T, lim = 7)

```

```{r}
# And then use the ID we find through this for other functions.
ghostid <- getArtistInfo("Ghost", byName = TRUE, dataframe = T, lim = 7)[2,]$id
topsongs <- getTopSongs(ghostid)
topsongs
```

```{r}
getSongInfo(topsongs[1,]$id, byName = F, dataframe = T)
```

```{r}
similar_to_ghost <- getRelatedArtists(artistId = "1Qp56T7n950O3EGMsSl81D", dataframe = TRUE)
similar_to_ghost
```

```{r}
getTopSongs("1Qp56T7n950O3EGMsSl81D", output = "graph")
```

```{r}
# This keeps breaking the CI checks for some reason
#getAudioFeatures(topsongs[1,]$id, output = "graph")
```




## Exploring New Tracks

Artist to ID conversion is built into the getTrackRecommendations function
so we can directly type names into the function.

Track to ID conversion is not yet implemented so we can use track seeds from
earlier to find new song recommendations. There seem to be some issues with
track seeds as vectors so we'll use only single tracks as our seeds.

Genres can be types as a vector if wanting multiple genres. Most genre tags you
can think of exist in the Spotify API search, but in case there's no return
try using other genre names.

```{r}
# I want more songs like 'Higher Love' by Kygo and Whitney Houston
getTrackRecommendations(seed_artists = c('kygo', 'whitney houston'),
                        seed_genres = c('tropical house', 'edm'),
                        seed_tracks = '6oJ6le65B3SEqPwMRNXWjY')
```
Say we aren't satisfied with our list. We can use other parameters to better
guide Spotify's recommendation API like so:
```{r}
getTrackRecommendations(seed_artists = c('kygo', 'whitney houston'),
                        seed_genres = c('tropical house', 'edm'),
                        seed_tracks = '6oJ6le65B3SEqPwMRNXWjY',
                        limit = 12,
                        market = 'US',
                        min_popularity = 70,
                        target_valence = 75)
```
## Wrapper Functions for Spotify Podcasts

